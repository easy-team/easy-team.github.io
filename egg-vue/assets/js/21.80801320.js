(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{146:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"基于-egg-vue-webpack-服务端渲染开发指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基于-egg-vue-webpack-服务端渲染开发指南"}},[t._v("#")]),t._v(" 基于 Egg + Vue + Webpack 服务端渲染开发指南")]),t._v(" "),s("h2",{attrs:{id:"_1-项目初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-项目初始化"}},[t._v("#")]),t._v(" 1. 项目初始化")]),t._v(" "),s("h3",{attrs:{id:"_1-1-easywebpack-cli-脚手架初始化项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-easywebpack-cli-脚手架初始化项目"}},[t._v("#")]),t._v(" 1.1 easywebpack-cli 脚手架初始化项目")]),t._v(" "),s("ol",{attrs:{start:"1"}},[s("li",[s("p",[t._v("安装脚手架 "),s("code",[t._v("npm install easywebpack-cli -g")]),t._v(" 命令行，然后就可以使用 "),s("code",[t._v("easywebpack")]),t._v(" 或 "),s("code",[t._v("easy")]),t._v(" 命令")])])]),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[t._v("命令行运行 "),s("code",[t._v("easywebpack init")])])])]),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("选择 egg+vue server side render boilerplate 初始化骨架项目")])])]),s("ol",{attrs:{start:"4"}},[s("li",[s("p",[t._v("安装依赖 "),s("code",[t._v("npm install")])])])]),t._v(" "),s("h3",{attrs:{id:"_1-2-github-仓库代码初始化项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-github-仓库代码初始化项目"}},[t._v("#")]),t._v(" 1.2 GitHub 仓库代码初始化项目")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/hubcarl/egg-vue-webpack-boilerplate.git\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" \n")])])]),s("p",[t._v("初始化的项目提供多页面和SPA(vue-router/axios)服务端渲染实例，可以直接运行。")]),t._v(" "),s("h3",{attrs:{id:"_1-3-vscode-插件初始化项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-vscode-插件初始化项目"}},[t._v("#")]),t._v(" 1.3 vscode 插件初始化项目")]),t._v(" "),s("p",{staticStyle:{"padding-left":"2em"}},[s("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=hubcarl.vscode-easy-plugin#overview",target:"_blank"}},[t._v("https://marketplace.visualstudio.com/items?itemName=hubcarl.vscode-easy-plugin#overview")])]),t._v(" "),s("h2",{attrs:{id:"_2-项目运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-项目运行"}},[t._v("#")]),t._v(" 2. 项目运行")]),t._v(" "),s("h3",{attrs:{id:"_2-1-本地运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-本地运行"}},[t._v("#")]),t._v(" 2.1 本地运行")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run dev   // egg-bin dev \n")])])]),s("p",[t._v("npm run dev 做了如下三件事情")]),s("ul",[s("li",[s("p",[t._v("启动 egg 应用")])])]),s("ul",[s("li",[s("p",[t._v("启动 Webpack 构建, 文件不落地磁盘，构建的文件都在内存里面(只在本地启动, 发布模式是提前构建好文件到磁盘)")])])]),s("ul",[s("li",[s("p",[t._v("构建会同时启动两个 Webpack 构建服务, 客户端js构建端口9000, 服务端端口9001")])])]),s("ul",[s("li",[s("p",[t._v("构建完成，Egg应用正式可用，自动打开浏览器")])])]),t._v(" "),s("h3",{attrs:{id:"_2-2-发布模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-发布模式"}},[t._v("#")]),t._v(" 2.2 发布模式")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("构建文件落地磁盘")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build 或 easy build prod \n")])])]),s("ol",{attrs:{start:"1"}},[s("li",[s("p",[t._v("启动 Webpack 构建，文件落地磁盘")])])]),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[t._v("服务端构建的文件放到 "),s("code",[t._v("app/view")]),t._v(" 目录")])])]),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("前端构建的文件放到 "),s("code",[t._v("public")]),t._v(" 目录")])])]),s("ol",{attrs:{start:"4"}},[s("li",[s("p",[t._v("生成的 "),s("code",[t._v("manifest.json")]),t._v(" 放到 "),s("code",[t._v("config")]),t._v(" 目录")])])]),s("ol",{attrs:{start:"5"}},[s("li",[s("p",[t._v("构建的文件都是 gitignore 的，"),s("strong",[s("span",{staticStyle:{color:"#1890FF"}},[t._v("部署时请注意把这些文件打包进去")])])])])]),s("ul",[s("li",[s("p",[t._v("运行")])])]),s("blockquote",[s("p",[t._v("非  "),s("code",[t._v("egg-scripts start")]),t._v("   方式启动时， 启动应用前， 请设置 "),s("code",[t._v("EGG_SERVER_ENV")]),t._v(" 环境变量，测试环境设置 "),s("code",[t._v("test")]),t._v("， 正式环境设置 "),s("code",[t._v("prod")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" start  // egg-scripts start \n")])])]),s("h2",{attrs:{id:"_3-项目构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-项目构建"}},[t._v("#")]),t._v(" 3. 项目构建")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("通过 "),s("code",[t._v("easywebpack-cli")]),t._v(" 统一构建，支持 dev，test，prod 模式构建")])])]),s("ul",[s("li",[s("p",[s("code",[t._v("easywebpack-cli")]),t._v(" 通过项目根目录下的 "),s("code",[t._v("webpack.config.js")]),t._v(" 配置文件构造出 Webpack 实际的配置文件，配置项请见 "),s("a",{attrs:{href:"https://www.yuque.com/easy-team/easywebpack/config",target:"_blank"}},[t._v("webpack.config.js")])])])]),s("ul",[s("li",[s("p",[t._v("获取 Webpack 实际的配置文件, "),s("a",{attrs:{href:"https://github.com/easy-team/egg-webpack",target:"_blank"}},[t._v("egg-webpack")]),t._v(" 会使用到该功能。构建会根据 "),s("code",[t._v("webpackConfigList.length")]),t._v(" 启动对应个数的 Webpack 编译实例，这里会同时启动两个 Webpack 构建服务, 客户端jsbundle构建，端口9000, 服务端jsbundle构建端口9001。默认端口为9000, 端口依次递增。")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// config/config.local.js 本地 npm start 使用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" EasyWebpack "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'easywebpack-vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nexports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webpack "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n webpackConfigList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("EasyWebpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWebpackConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("ul",[s("li",[s("p",[t._v("该项目中，"),s("code",[t._v("app/web/page")]),t._v(" 目录中所有 .vue 文件当作 Webpack 构建入口是采用 app/web/framework/vue/entry 的 "),s("strong",[t._v("client-loader.js")]),t._v(" 和 "),s("strong",[t._v("server-loader.js ")]),t._v("模板实现的，这个需要结合 "),s("code",[t._v("webpack.config.js")]),t._v(" 下的 entry.loader 使用。 骨架最新版本已被下面 "),s("a",{attrs:{href:"https://github.com/isaacs/node-glob",target:"_blank"}},[t._v("node-glob")]),t._v(" 模式所替换。 "),s("span",{staticStyle:{color:"#52C41A"}},[t._v("这种方式可以自定义 entry 初始化模板")]),t._v("。")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/web/page'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  exclude"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/web/page/[a-z]+/component'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/web/page/app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  loader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果没有配置loader模板，默认使用 .js 文件作为构建入口")]),t._v("\n     client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/web/framework/vue/entry/client-loader.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/web/framework/vue/entry/server-loader.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\t\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),s("ul",[s("li",[s("p",[t._v("使用 "),s("a",{attrs:{href:"https://github.com/isaacs/node-glob",target:"_blank"}},[t._v("node-glob")]),t._v(" 遍历文件。下面配置会自动遍历 "),s("code",[t._v("app/web/page")]),t._v("  目录的所有 vue 文件作为 entry 入口，排除 "),s("code",[t._v("component|components|view|views")]),t._v(" 目录下的文件。 这个是 "),s("a",{attrs:{href:"https://github.com/easy-team/egg-vue-webpack-boilerplate",target:"_blank"}},[t._v("egg vue ssr ")]),t._v(" 项目默认配置,  同时使用 "),s("a",{attrs:{href:"https://github.com/easy-team/vue-entry-loader",target:"_blank"}},[t._v("vue-entry-loader")]),t._v("  作为模板入口 。"),s("span",{staticStyle:{color:"#1890FF"}},[t._v("easywebpack@4.8.0 开始支持，因为有了默认配置，所以最新的骨架项目中，webpack.config.js 文件为非必须配置。")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.config.js")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意 只有 entry 文件是 .vue 文件(非.js）时，才会自动使用 vue-entry-loader 模板")]),t._v("\n entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/web/page/**!(component|components|view|views)/*.vue'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])])])]),t._v(" "),s("h2",{attrs:{id:"_4-项目规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-项目规范"}},[t._v("#")]),t._v(" 4. 项目规范")]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://eggjs.org/zh-cn/basics/structure.html",target:"_blank"}},[t._v("遵循 egg 开发规范")])])])]),s("ul",[s("li",[s("p",[t._v("Vue 项目代码放到 app/web 目录，页面入口目录为 page，该目录的 所有 vue 文件默认会作为 Webpack 的 entry 构建入口。建议每个页面目录的只保留一个vue文件，vue关联的组件可以放到widget 或者 compnent目录。如果非要放到当前目录，请配置 "),s("code",[t._v("webpack.config.js")]),t._v(" entry.exclude 排除 vue文件。")])])]),s("p",[s("img",{staticStyle:{"max-width":"600px",width:"234px"},attrs:{src:"https://cdn.yuque.com/yuque/0/2018/png/116733/1528521398498-da1702b8-03e0-455b-8efc-b1ebb005abf3.png#width=234"}})]),t._v(" "),s("h2",{attrs:{id:"_5-项目开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-项目开发"}},[t._v("#")]),t._v(" 5. 项目开发")]),t._v(" "),s("p",[t._v("支持多页面/单页面服务端渲染, 前端渲染, 静态页面三种方式.")]),t._v(" "),s("h3",{attrs:{id:"_5-1-多页面服务端渲染实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-多页面服务端渲染实现"}},[t._v("#")]),t._v(" 5.1 多页面服务端渲染实现")]),t._v(" "),s("h4",{attrs:{id:"_5-1-1-多页面前端页面实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-1-多页面前端页面实现"}},[t._v("#")]),t._v(" 5.1.1 多页面前端页面实现")]),t._v(" "),s("p",[t._v("在app/web/page 目录下面创建home目录, home.vue 文件, Webpack自动根据.vue文件创建entry入口, 具体实现请见"),s("a",{attrs:{href:"https://www.yuque.com/easy-team/easywebpack/config",target:"_blank"}},[t._v("webpack.config.js")])]),s("ul",[s("li",[s("p",[t._v("home.vue 编写界面逻辑, 根元素为layout(自定义组件, 全局注册, 统一的html, meta, header, body, 你可以自定义 title，description，keywords SEO信息，更多信息请扩展layout).")])])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("layout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("基于egg-vue-webpack-dev和egg-view-vue插件的工程示例项目"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("vue server side render"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keywords")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("egg, vue, webpack, server side render"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  {{message}}\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("layout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token style"}},[s("span",{pre:!0,attrs:{class:"token language-css"}},[t._v("\n "),s("span",{pre:!0,attrs:{class:"token atrule"}},[s("span",{pre:!0,attrs:{class:"token rule"}},[t._v("@import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"home.css"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")])]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/babel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   components"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   computed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   methods"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n")])])]),s("h4",{attrs:{id:"_5-1-2-多页面后端渲染实现-通过-egg-view-vue-ssr-插件-render-方法实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-2-多页面后端渲染实现-通过-egg-view-vue-ssr-插件-render-方法实现"}},[t._v("#")]),t._v(" 5.1.2 多页面后端渲染实现, 通过 egg-view-vue-ssr 插件 render 方法实现")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("创建controller文件home.js")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("exports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'home/home.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue server side render!'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("ul",[s("li",[s("p",[t._v("添加路由配置")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("h4",{attrs:{id:"_5-1-3-多页面走前端渲染-后端路由-实现-通过-egg-view-vue-ssr-插件-renderclient-方法实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-3-多页面走前端渲染-后端路由-实现-通过-egg-view-vue-ssr-插件-renderclient-方法实现"}},[t._v("#")]),t._v(" 5.1.3 多页面走前端渲染(后端路由)实现, 通过 egg-view-vue-ssr 插件 renderClient 方法实现")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("创建controller文件home.js")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("exports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("client")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderClient")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'home/home.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue server side render!'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("ul",[s("li",[s("p",[t._v("添加路由配置")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/client'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("h3",{attrs:{id:"_5-2-html静态页面前端渲染"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-html静态页面前端渲染"}},[t._v("#")]),t._v(" 5.2 HTML静态页面前端渲染")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("直接有easywebpack构建出静态HTML文件, 请见 "),s("code",[t._v("webpack.config.js")]),t._v(" 配置和 "),s("code",[t._v("app/web/page/html")]),t._v("代码实现")])])]),s("ul",[s("li",[s("p",[t._v("通过 "),s("code",[t._v("egg-static")]),t._v(" 静态文件访问HTML文件")])])]),t._v(" "),s("h3",{attrs:{id:"_5-3-单页面服务器渲染同构实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-单页面服务器渲染同构实现"}},[t._v("#")]),t._v(" 5.3 单页面服务器渲染同构实现")]),t._v(" "),s("h4",{attrs:{id:"_5-3-1-单页面前端实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-单页面前端实现"}},[t._v("#")]),t._v(" 5.3.1 单页面前端实现")]),t._v(" "),s("p",[t._v("在app/web/page 目录下面创建app目录, app.vue, app.js 文件.")]),s("ul",[s("li",[s("p",[t._v("app.vue 编写界面逻辑, 根元素为layout(自定义组件, 全局注册, 统一的html, meta, header, body)")])])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("app-layout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("transition")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("fade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("mode")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("out-in"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("router-view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("router-view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("transition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("app-layout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("sass"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token style"}},[s("span",{pre:!0,attrs:{class:"token language-css"}},[t._v("\n\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/babel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   computed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n")])])]),s("ul",[s("li",[s("p",[t._v("app.js 页面调用入口")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" sync "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vuex-router-sync'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" store "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'store/app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" router "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'component/app/router'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./app.vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Layout "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'component/layout/app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nApp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Layout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Layout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("store"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n store\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("h4",{attrs:{id:"_5-3-2-单页面后端实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-单页面后端实现"}},[t._v("#")]),t._v(" 5.3.2 单页面后端实现")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("创建controller文件app.js")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("exports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/app.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/\\/app/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("ul",[s("li",[s("p",[t._v("添加路由配置")])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/app(/.+)?'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("h2",{attrs:{id:"_6-项目部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-项目部署"}},[t._v("#")]),t._v(" 6. 项目部署")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("正式环境部署，请设置 "),s("code",[t._v("EGG_SERVER_ENV=prod")]),t._v(" 环境变量, 更多请见"),s("a",{attrs:{href:"https://eggjs.org/zh-cn/basics/env.html",target:"_blank"}},[t._v("运行环境")])])])]),s("ul",[s("li",[s("p",[t._v("构建的 "),s("code",[t._v("app/view")]),t._v(" 目录, "),s("code",[t._v("public")]),t._v(" 目录以及 "),s("code",[t._v("buildConfig.json")]),t._v(" 和 "),s("code",[t._v("manifest.json")]),t._v("等文件, 都是 "),s("code",[t._v("gitignore")]),t._v(" 的，部署时请注意把这些文件打包进去。")])])]),t._v(" "),s("h2",{attrs:{id:"_7-构建目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-构建目录"}},[t._v("#")]),t._v(" 7. 构建目录")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Webpack构建服务端(Node) JSBundle运行文件, 构建的服务端渲染模板文件位置 "),s("code",[t._v("${app_root}/app/view")])])])]),s("ul",[s("li",[s("p",[t._v("Webpack构建浏览器JSBundle运行文件, 构建的前端资源(js/css/image)文件位置 "),s("code",[t._v("${app_root}/public")])])])]),s("ul",[s("li",[s("p",[t._v("Webpack构建的 "),s("code",[t._v("manifest.json")]),t._v(" 文件位置 "),s("code",[t._v("${app_root}/config")]),t._v(" 目录")])])]),s("ul",[s("li",[s("p",[t._v("easywebpack-cli 构建配置文件 "),s("code",[t._v("webpack.config.js")]),t._v(" 放到项目根目录"),s("code",[t._v("${app_root}/webpack.config.js")])])])]),s("ul",[s("li",[s("p",[t._v("Vue代码文件"),s("code",[t._v("${app_root}/app/web")]),t._v(" 下面, 主要包括 "),s("code",[t._v("asset")]),t._v(", "),s("code",[t._v("component")]),t._v(", "),s("code",[t._v("framework")]),t._v(", "),s("code",[t._v("page")]),t._v(", "),s("code",[t._v("store")]),t._v(", "),s("code",[t._v("view")]),t._v(" 等目录")])])]),t._v(" "),s("div",{staticClass:"language-undefined extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("├── asset\n│   ├── css\n│   │   ├── normalize.css\n│   │   └── style.css\n│   ├── images\n│   │   ├── favicon.ico\n│   │   ├── loading.gif\n│   │   └── logo.png\n├── component\n│   ├── app\n│   │   ├── detail.vue\n│   │   ├── list.vue\n│   │   └── router.js\n│   ├── layout\n│   │   ├── app\n│   │   │   ├── content\n│   │   │   │   ├── content.css\n│   │   │   │   └── content.vue\n│   │   │   ├── footer\n│   │   │   │   ├── footer.css\n│   │   │   │   └── footer.vue\n│   │   │   ├── header\n│   │   │   │   ├── header.css\n│   │   │   │   └── header.vue\n│   │   │   ├── index.js\n│   │   │   └── main.vue\n├── framework\n│   ├── inject\n│   │   ├── global.css\n│   │   ├── inline.js\n│   │   └── pack-inline.js\n│   └── vue\n│       ├── app.js\n│       ├── component\n│       │   └── index.js\n│       ├── directive\n│       │   └── index.js\n│       └── filter\n│           └── index.js\n├── page\n│   ├── app\n│   │   ├── app.js\n│   │   └── app.vue\n│   ├── index\n│   │   ├── index.css\n│   │   ├── index.js\n│   │   └── index.vue\n├── store\n│   └── app\n│       ├── actions.js\n│       ├── getters.js\n│       ├── index.js\n│       ├── mutation-type.js\n│       └── mutations.js\n└── view\n   └── layout.html \n")])])]),s("h3",{attrs:{id:"二-项目结构和基本规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二-项目结构和基本规范"}},[t._v("#")]),t._v(" 二. 项目结构和基本规范")]),t._v(" "),s("div",{staticClass:"language-undefined extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("├── app\n│   ├── controller\n│   │   ├── test\n│   │   │   └── test.js\n│   ├── extend\n│   ├── lib\n│   ├── middleware\n│   ├── mocks\n│   ├── proxy\n│   ├── router.js\n│   ├── view\n│   │   ├── about                         // 服务器编译的jsbundle文件\n│   │   │   └── about.js\n│   │   ├── home\n│   │   │     └── home.js                 // 服务器编译的jsbundle文件\n│   │   └── layout.js                     // 编译的layout文件\n│   └── web                               // 前端工程目录\n│       ├── asset                         // 存放公共js,css资源\n│       ├── framework                     // 前端公共库和第三方库\n│       │   └── entry                          \n│       │       ├── loader.js              // 根据jsx文件自动生成entry入口文件loader\n│       ├── page                           // 前端页面和webpack构建目录, 也就是webpack打包配置entryDir\n│       │   ├── home                       // 每个页面遵循目录名, js文件名, scss文件名, jsx文件名相同\n│       │   │   ├── home.scss\n│       │   │   ├── home.jsx\n│       │   └── hello                      // 每个页面遵循目录名, js文件名, scss文件名, jsx文件名相同\n│       │       ├── test.css               // 服务器render渲染时, 传入 render('test/test.js', data)\n│       │       └── test.jsx\n│       ├── store                             \n│       │   ├── app\n│       │   │   ├── actions.js\n│       │   │   ├── getters.js\n│       │   │   ├── index.js\n│       │   │   ├── mutation-type.js\n│       │   │   └── mutations.js\n│       │   └── store.js\n│       └── component                         // 公共业务组件, 比如loading, toast等, 遵循目录名, js文件名, scss文件名, jsx文件名相同\n│           ├── loading\n│           │   ├── loading.scss\n│           │   └── loading.jsx\n│           ├── test\n│           │   ├── test.jsx\n│           │   └── test.scss\n│           └── toast\n│               ├── toast.scss\n│               └── toast.jsx\n├── config\n│   ├── config.default.js\n│   ├── config.local.js\n│   ├── config.prod.js\n│   ├── config.test.js\n│   └── plugin.js\n├── doc\n├── index.js\n├── webpack.config.js                      // easywebpack-cli 构建配置\n├── public                                 // webpack编译目录结构, render文件查找目录\n│   ├── static\n│   │   ├── css\n│   │   │   ├── home\n│   │   │   │   ├── home.07012d33.css\n│   │   │   └── test\n│   │   │       ├── test.4bbb32ce.css\n│   │   ├── img\n│   │   │   ├── change_top.4735c57.png\n│   │   │   └── intro.0e66266.png\n│   ├── test\n│   │   └── test.js\n│   └── vendor.js                         // 生成的公共打包库 \n")])])]),s("h2",{attrs:{id:"_8-项目和插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-项目和插件"}},[t._v("#")]),t._v(" 8. 项目和插件")]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://github.com/easy-team/egg-vue-webpack-boilerplate",target:"_blank"}},[t._v("egg-vue-webpack-boilerplate")]),t._v(" 基于easywebpack-vue和egg-view-vue(ssr)插件的工程骨架项目")])])]),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://github.com/easy-team/easywebpack-vue",target:"_blank"}},[t._v("easywebpack-vue")]),t._v(" Webpack Vue 构建工程化方案.")])])]),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://github.com/easy-team/easywebpack-cli",target:"_blank"}},[t._v("easywebpack-cli")]),t._v("  Webpack 构建工程化脚手架.")])])]),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://github.com/easy-team/egg-view-vue-ssr",target:"_blank"}},[t._v("egg-view-vue-ssr")]),t._v(" egg vue ssr 解决方案.")])])]),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://github.com/easy-team/egg-webpack",target:"_blank"}},[t._v("egg-webpack")]),t._v(" 本地开发热更新使用.")])])]),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://github.com/easy-team/egg-webpack-vue",target:"_blank"}},[t._v("egg-webpack-vue")]),t._v(" 本地开发渲染内存读取辅助插件")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);