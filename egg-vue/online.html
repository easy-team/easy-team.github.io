<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>项目开发 | Egg + Vue 工程化解决方案</title>
    <meta name="description" content="Egg + Vue 服务端和前端渲染工程方案">
    
    
    <link rel="preload" href="/egg-vue/assets/css/0.styles.79987df1.css" as="style"><link rel="preload" href="/egg-vue/assets/js/app.1ad586ba.js" as="script"><link rel="preload" href="/egg-vue/assets/js/2.67c62971.js" as="script"><link rel="preload" href="/egg-vue/assets/js/12.03115eb8.js" as="script"><link rel="prefetch" href="/egg-vue/assets/js/10.5913bca5.js"><link rel="prefetch" href="/egg-vue/assets/js/11.61e8966f.js"><link rel="prefetch" href="/egg-vue/assets/js/13.b3b0b2e5.js"><link rel="prefetch" href="/egg-vue/assets/js/14.c3af845f.js"><link rel="prefetch" href="/egg-vue/assets/js/15.c4d16641.js"><link rel="prefetch" href="/egg-vue/assets/js/16.d5ea3b1b.js"><link rel="prefetch" href="/egg-vue/assets/js/17.d3aa1c4c.js"><link rel="prefetch" href="/egg-vue/assets/js/18.859ef396.js"><link rel="prefetch" href="/egg-vue/assets/js/19.9124f1fa.js"><link rel="prefetch" href="/egg-vue/assets/js/20.9542dbde.js"><link rel="prefetch" href="/egg-vue/assets/js/21.6a7ed926.js"><link rel="prefetch" href="/egg-vue/assets/js/22.6dd0d737.js"><link rel="prefetch" href="/egg-vue/assets/js/23.a53e99f9.js"><link rel="prefetch" href="/egg-vue/assets/js/24.78389b2f.js"><link rel="prefetch" href="/egg-vue/assets/js/25.45266e9e.js"><link rel="prefetch" href="/egg-vue/assets/js/3.8ff6cff4.js"><link rel="prefetch" href="/egg-vue/assets/js/4.e73e36c5.js"><link rel="prefetch" href="/egg-vue/assets/js/5.79e85244.js"><link rel="prefetch" href="/egg-vue/assets/js/6.70ec450c.js"><link rel="prefetch" href="/egg-vue/assets/js/7.5134000b.js"><link rel="prefetch" href="/egg-vue/assets/js/8.b57e23ca.js"><link rel="prefetch" href="/egg-vue/assets/js/9.74b06747.js">
    <link rel="stylesheet" href="/egg-vue/assets/css/0.styles.79987df1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/egg-vue/" class="home-link router-link-active"><!----> <span class="site-name">Egg + Vue 工程化解决方案</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/egg-vue/easywebpack.html" class="nav-link">easywebpack</a></div><div class="nav-item"><a href="/egg-vue/egg-vue.html" class="nav-link">egg + vue</a></div><div class="nav-item"><a href="/egg-vue/egg-react.html" class="nav-link">egg + react</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/egg-vue/easywebpack.html" class="nav-link">easywebpack</a></div><div class="nav-item"><a href="/egg-vue/egg-vue.html" class="nav-link">egg + vue</a></div><div class="nav-item"><a href="/egg-vue/egg-react.html" class="nav-link">egg + react</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/egg-vue/case.html" class="sidebar-link">项目一览</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>新手指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/egg-vue/init.html" class="sidebar-link">快速开始</a></li><li><a href="/egg-vue/start.html" class="sidebar-link">从零开始</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/egg-vue/render.html" class="sidebar-heading clickable"><span>渲染模式</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/egg-vue/node.html" class="sidebar-link">服务端渲染模式</a></li><li><a href="/egg-vue/web.html" class="sidebar-link">前端渲染模式</a></li><li><a href="/egg-vue/asset.html" class="sidebar-link">asset 渲染模式</a></li></ul></section></li><li><a href="/egg-vue/qpeiow.html" class="sidebar-link">入口实现</a></li><li><a href="/egg-vue/build.html" class="sidebar-link">构建流程</a></li><li><a href="/egg-vue/online.html" class="active sidebar-link">部署流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/egg-vue/online.html#项目开发" class="sidebar-link">项目开发</a></li><li class="sidebar-sub-header"><a href="/egg-vue/online.html#骨架模板" class="sidebar-link">骨架模板</a></li></ul></li><li><a href="/egg-vue/version.html" class="sidebar-link">插件使用</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>特性介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/egg-vue/seo.html" class="sidebar-link">SEO实现</a></li><li><a href="/egg-vue/async.html" class="sidebar-link">异步加载</a></li><li><a href="/egg-vue/typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/egg-vue/pwa.html" class="sidebar-link">Service Worker</a></li><li><a href="/egg-vue/i18n.html" class="sidebar-link">i18n 国际化支持</a></li><li><a href="/egg-vue/babel.html" class="sidebar-link">Babel 构建优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/egg-vue/about.html" class="sidebar-heading clickable"><span>相关问题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/egg-vue/open.html" class="sidebar-link">社区作品</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h2 id="项目开发"><a href="#项目开发" aria-hidden="true" class="header-anchor">#</a> 项目开发</h2> <p>在 <a href="https://github.com/easy-team/egg-vue-webpack-boilerplate" target="_blank">egg-vue-webpack-boilerplate</a> 骨架项目中, 提供了一些demo, 如果要进行新项目开发，可以删除部分文件：</p><ul><li><p>app/web/page 是页面目录。下面的每个目录都是一个单独的页面，其中 app 目录是一个单页面服务端渲染例子，其他是简单的 Vue 服务端渲染例子， 这些文件都可以删除，删除后，你需要自己按照类似方式添加页面进行开发。</p></li></ul><ul><li><p>app/controller 是服务端页面处理逻辑入口，下面都是例子，可以删除， 然后自己根据业务添加对应的controller</p></li></ul><ul><li><p>asset 是几个公共的静态资源文件，如果 app/web/component下面没有引用到，可以根据需要删除</p></li></ul><ul><li><p>controller 和 page 删除了部分文件后，需要清理 app/router.js 和 webpack.config.js 下面文件不存在的一下配置</p></li></ul><ul><li><p>app/web/component 下面的 app 是单页面的 router 配置，如果 app/web/page/app  删除了，这个也可以删除</p></li></ul><ul><li><p>app/web/component/layout 提供了单页面 layout 和 多页面 layout, 自己根据需要选用。</p></li></ul> <h2 id="骨架模板"><a href="#骨架模板" aria-hidden="true" class="header-anchor">#</a> 骨架模板</h2> <p><a href="https://github.com/easy-team/egg-vue-webpack-boilerplate" target="_blank">egg-vue-webpack-boilerplate</a> 项目单独提供了两个纯净版本分支用于实际项目开发</p><ul><li><p>Egg + Vue + axios 多页面服务端渲染分支 <a href="https://github.com/hubcarl/egg-vue-webpack-boilerplate/tree/feature/green/multi" target="_blank">feature/green/multi</a></p></li></ul><ul><li><p>Egg + Vue + Vue-Router + Vuex + Axios 单页面服务端渲染分支 <a href="https://github.com/hubcarl/egg-vue-webpack-boilerplate/tree/feature/green/spa" target="_blank">feature/green/spa</a></p></li></ul> <h3 id="命令配置"><a href="#命令配置" aria-hidden="true" class="header-anchor">#</a> 命令配置</h3> <p style="padding-left:2em;">一般我们推荐把 <code>easy build dev</code>, <code>easy build test</code>, <code>easy build prod</code> 配置到 项目的 <code>package.json</code> 的 script 中去, 然后通过 npm run [command] 的方式使用。</p><ul><li><p>通过 <code>npm run [command]</code> 方式使用 easy 命令时，不需要全局安装 <code>easywepback-cli</code> 命令行工具, 只需要把 <code>easywepback-cli</code> 安装到项目 <code>devDependencies</code> 即可。</p></li></ul><ul><li><p>在命令行直接使用 <code>easy</code> 命令时，需要全局安装 <code>easywepback-cli</code> 命令行工具。如果不安装, 可以通过 npm5 支持的 <code>npx easy</code> 方式运行。</p></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;clean&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;easy clean&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;debug&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;egg-bin debug&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;build&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;cross-env easy clean &amp;&amp; easy build prod&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;egg-bin dev&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;start&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;egg-scripts start&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre></div><ul><li><p>本项目本地开发过程中, <code>npm run dev</code>  自动启动 Webpack 内存构建，无需手动构建;</p></li></ul><ul><li><p><strong><span style="color:#096DD9;">测试环境和正式环境发布部署一定要先进行 </span></strong><strong><span style="color:#096DD9;">npm run build</span></strong><code></code><strong><span style="color:#096DD9;"> 模式构建，然后再打包, 只用 </span></strong><strong><span style="color:#096DD9;">npm start</span></strong><code></code><strong><span style="color:#096DD9;">  启动即可</span></strong></p></li></ul><ul><li><p>如果不是用 <code>egg-scripts start</code> 启动应用， 请配置 <a href="https://eggjs.org/zh-cn/basics/env.html" target="_blank">EGG_SERVER_ENV</a> 环境变量。<code>EGG_SERVER_ENV</code>表示 Egg 用那种方式启动, <code>test</code> 表示读取 <code>config.test.js</code> 配置， <code>prod</code> 表示读取 <code>config.prod.js</code> 配置， 正式线上运行一定要用 <code>prod</code> 模式。例如自己写 <code>index.js</code>  启动脚本, 然后通过 <code>node index.js</code>   启动时，请配置 <a href="https://eggjs.org/zh-cn/basics/env.html" target="_blank">EGG_SERVER_ENV</a> 环境变量。</p></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ${root}/index.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startCluster</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 baseDir<span class="token punctuation">:</span> __dirname<span class="token punctuation">,</span>
 port<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h4 id="本地开发模式"><a href="#本地开发模式" aria-hidden="true" class="header-anchor">#</a> 本地开发模式</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run dev 
</code></pre></div><p>使用 <code>egg-webpack</code> 插件进行前端资源构建, 这个插件只会在本地开发启用。</p> <h4 id="本地模拟测试环境"><a href="#本地模拟测试环境" aria-hidden="true" class="header-anchor">#</a> 本地模拟测试环境</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run build:test
<span class="token function">npm</span> run start:test 
</code></pre></div><h4 id="本地模拟正式环境"><a href="#本地模拟正式环境" aria-hidden="true" class="header-anchor">#</a> 本地模拟正式环境</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run build
<span class="token function">npm</span> run start 
</code></pre></div><h3 id="打包部署"><a href="#打包部署" aria-hidden="true" class="header-anchor">#</a> 打包部署</h3> <p>项目开发完成以后，我们要部署上线, 一般如下步骤:</p> <h4 id="清除缓存"><a href="#清除缓存" aria-hidden="true" class="header-anchor">#</a> 清除缓存</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run clean 
</code></pre></div><h4 id="开始构建"><a href="#开始构建" aria-hidden="true" class="header-anchor">#</a> 开始构建</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run build 
</code></pre></div><h4 id="打包上传"><a href="#打包上传" aria-hidden="true" class="header-anchor">#</a> 打包上传</h4> <blockquote><p>这里需要你自己实现把构建好的文件和项目问题一起打成 zip 或 tar 包，然后上传到部署平台进行部署。参数配置请见：<a href="https://www.yuque.com/easy-team/easywebpack/build" target="_blank">https://www.yuque.com/easy-team/easywebpack/build</a></p></blockquote><ul><li><p>需要把构建后的文件(public目录，app/view 目录， config/manifest.json)与项目源代码一起打包部署，当然部分文件(README.md, eslint, gitignore等)可以不打进去。</p></li></ul><ul><li><p>如果 <code>node_modules</code> 在打包时也打进去，packjson.json 里面的 devDependencies 依赖是不需要打进去的，这些只在开发期间和 Webpack 构建期间用到，不需要打进去。如果打进去也没有问题，只是包非常大，部署上传是个问题。</p></li></ul><ul><li><p>如果 <code>node_modules</code> 在打包时不打进去，在<strong>启动</strong>之前，你需要先按照依赖 <code>npm install --production</code></p></li></ul> <h5 id="cli-zip打包-内置依赖和node-："><a href="#cli-zip打包-内置依赖和node-：" aria-hidden="true" class="header-anchor">#</a> cli zip打包(内置依赖和node)：</h5> <p><strong>这里会把代码，构建文件，node_modules 以及 node 一起压缩程 zip， 这样线上在启动时就不需要按照依赖。</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>easy clean all
easy build prod
easy <span class="token function">zip</span> --deps --nodejs 
</code></pre></div><h5 id="cli-zip打包-线上安装依赖-："><a href="#cli-zip打包-线上安装依赖-：" aria-hidden="true" class="header-anchor">#</a> cli zip打包(线上安装依赖)：</h5> <p><strong>这里仅仅把代码，构建文件一起压缩程 zip， 这样线上在启动时需要运行 npm install --production 按照依赖。</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>easy clean all
easy build prod
easy <span class="token function">zip</span> 
</code></pre></div><h4 id="线上项目启动"><a href="#线上项目启动" aria-hidden="true" class="header-anchor">#</a> 线上项目启动</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> start 
</code></pre></div><p><span style="color:#262626;"><span style="background-color:#FFFFFF;">如果不是用 </span></span><span style="color:#262626;"><span style="background-color:#FFFFFF;"><code>egg-scripts start</code></span></span><span style="color:#262626;"><span style="background-color:#FFFFFF;"> 启动应用， 请配置 </span></span><a href="https://eggjs.org/zh-cn/basics/env.html" target="_blank">EGG_SERVER_ENV</a><span style="color:#262626;"><span style="background-color:#FFFFFF;"> 环境变量 </span></span><span style="color:#262626;"><span style="background-color:#FFFFFF;"><code>EGG_SERVER_ENV=prod NODE_ENV=production</code></span></span><span style="color:#262626;"><span style="background-color:#FFFFFF;">  配置环境变量.</span></span></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/egg-vue/build.html" class="prev">
          构建流程
        </a></span> <span class="next"><a href="/egg-vue/version.html">
          插件使用
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/egg-vue/assets/js/app.1ad586ba.js" defer></script><script src="/egg-vue/assets/js/2.67c62971.js" defer></script><script src="/egg-vue/assets/js/12.03115eb8.js" defer></script>
  </body>
</html>
